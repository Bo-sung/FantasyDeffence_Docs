# 세금 시스템

[← 영지 시스템](../영지%20시스템.md)

---

## 세금 공식

```
시간당 세금(은화) = 세금 계수 × 총 인구수 × 만족도
```

---

## 영주성 레벨별 세금 계수 (만렙 50)

| 영주성 레벨 | 세금 계수 |
|-------------|-----------|
| 1 | 1.0 |
| 5 | 1.1 |
| 10 | 1.2 |
| 15 | 1.3 |
| 20 | 1.5 |
| 25 | 1.5 |
| 30 | 1.8 |
| 40 | 2.2 |
| 45 | 2.3 |
| 50 | 2.5 |

※ 중간 레벨은 선형 보간

---

## 영주성 레벨업 비용

| 레벨 | 비용 | 해금 내용 |
|------|------|-----------|
| 1 | - | 농장, 민가, 우물, 수리실, 주점 (기본) |
| 5 | (TBD) | 마력 정제소, 연립 주택, 방앗간, 무기고, 대장간 |
| 10 | (TBD) | 구역 확장 (거리 1: 평원, 강변) |
| 15 | (TBD) | 보급창고, 상가 건물, 교회, 광장, 공병 작업장 |
| 25 | (TBD) | 구역 확장 (거리 2: 숲, 습지) |
| 30 | (TBD) | 훈련소, 시장 |
| 40 | (TBD) | 구역 확장 (거리 3: 산악, 해안) |
| 45 | (TBD) | 도서관 |

---

## 인구수 (주거 시설 레벨별)

| 시설 | Lv.1 | Lv.2 | Lv.3 | Lv.4 | Lv.5 |
|------|------|------|------|------|------|
| 민가 | 2 | 3 | 4 | 5 | 6 |
| 연립 주택 | 6 | 9 | 12 | 15 | 18 |
| 상가 건물 | 4 | 6 | 8 | 10 | 12 |

---

## 세금 수령

- **영주성 클릭** → 누적 세금 수령
- **전체 수확 버튼**으로도 수령 가능

---

## 세금 예시

```
영주성 Lv.10 (계수 1.2)
민가 3개 (인구 6) + 연립 2개 (인구 12) = 총 인구 18
우물 2개 (+10%) + 방앗간 1개 (+10%) = 만족도 70%

시간당 세금 = 1.2 × 18 × 0.7 = 15.12 은화
```

---

## 세금 계산 함수

```csharp
public void UpdateTax(float deltaSeconds)
{
    float satisfaction = CalculateSatisfaction();
    float taxCoeff = ConfigCastle.Get(_gameState.CastleLevel).TaxCoefficient;

    int totalPopulation = 0;
    foreach (var building in _gameState.Buildings)
    {
        var config = ConfigBuilding.Get(building.BuildingId);
        if (config.Category == BuildingCategory.HOUSING)
        {
            totalPopulation += config.Levels[building.Level].Population;
        }
    }

    float taxPerHour = taxCoeff * totalPopulation * satisfaction;
    float taxEarned = (taxPerHour / 3600f) * deltaSeconds;
    _gameState.AccumulatedTax += taxEarned;
}

public void HarvestTax()
{
    _gameState.Silver += Mathf.FloorToInt(_gameState.AccumulatedTax);
    _gameState.AccumulatedTax = 0f;
}
```
