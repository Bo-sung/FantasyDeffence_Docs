---
tags: [plan, client, server]
---

# 맵·구역 시스템

[← 영지 시스템](../영지%20시스템.md)

---

## 격자 스펙

| 항목 | 값 |
|------|-----|
| 전체 맵 | 30 × 30 타일 |
| 타일 크기 | 1 × 1 (기본 단위) |
| 성벽 두께 | 1 타일 (외곽 테두리) |
| 영주성 | 중앙 4 × 4, 이동/삭제 불가 |
| 유효 배치 영역 | 28 × 28 (성벽 제외) |

---

## 맵 구조

> **용어 정의:**
> - **타일**: 1×1 최소 건설 단위
> - **영역**: 해금된 타일의 집합 (건설 가능 구역)
> - **맵**: 30×30 타일 전체 (고정)
> - **구역 테마**: 지형별 비주얼 명칭 (시작 영역, 평원, 강변, 숲, 습지, 산악, 해안 등)
>   - 게임플레이 효과 없음 (동네 이름처럼 장식적 요소)

### 개념도

```
┌─────────────────────────────────────┐
│ 미해금 영역                          │
│     ┌───────────────────┐           │
│     │  해금된 영역      │           │
│     │   ┌─────────┐     │           │
│     │   │  ■■■■ │     │           │  영주성 (4×4, 16타일)
│     │   │  ■■■■ │     │           │  기본 영역 + 확장 영역
│     │   │  ■■■■ │     │           │
│     │   │  ■■■■ │     │           │
│     │   └─────────┘     │           │
│     │                   │           │
│     └───────────────────┘           │
│                                     │
└─────────────────────────────────────┘

■ = 영주성 (4×4, 16타일)
□ = 해금된 영역 (건설 가능)
░ = 미해금 영역 (건설 불가)
```

---

## 영역 확장 시스템

> 영역 = 건설 가능한 타일의 집합
> 영역 확장 = 새로운 타일 해금 → 건설 가능 부지 증가

### 시작 영역

- **기본 제공**: 영주성(4×4, 16타일) 주변 일정 범위
- **초기 크기**: 영주성 중심 기준 16×16 타일 (사각 영역)
- **구역 테마**: "시작 영역 (중앙)"

### 확장 조건

| 항목 | 설명 |
|------|------|
| **구매 제한 해제** | 영주성 레벨 10 이상 |
| **구매 비용** | 은화 (거리에 따라 증가) |
| **확장 단위** | 타일 단위 (1×1) |

### 레벨별 확장 가능 구역 테마

| 레벨 | 확장 가능 구역 | 비고 |
|------|----------------|------|
| 1 | 시작 영역 (중앙) | 기본 제공 |
| 10 | 평원, 강변 | 영역 확장 해금 |
| 25 | 숲, 습지 | 더 먼 지역 확장 |
| 40 | 산악, 해안 | 최외곽 지역 확장 |

> **참고**: 구역 테마는 비주얼 명칭일 뿐, 게임플레이 효과(생산 보너스 등)는 없습니다.

### 확장 규칙

**시스템 제약 (필수)**:
- **인접 영역만 확장 가능**: 기존 해금된 타일에 인접한 타일만 구매 가능

**기획 가이드 (권장)**:
- **거리 제약**: 기존 영역에서 3타일 이내 권장 (가느다란 선 형태 방지)
- **최소 너비**: 돌출 영역 최소 2타일 너비 권장 (미관상)

> **참고**: 거리/너비 제약은 기획 의도이며 시스템적으로 강제되지 않습니다.

---

## 고정 요소

| 요소 | 위치 | 설명 |
|------|------|------|
| 영주성 | 시작 영역 중앙 (4×4) | 핵심 시설, 이동 불가, 세금 수령 |
| 성벽 | 외곽 1타일 | 경계 표시, 장식 요소 |

---

## 맵 데이터 구조

```csharp
// 맵 전체: 30×30 타일
const int MapSizeX = 30;
const int MapSizeY = 30;

// 건물 배치: 0=빈 타일, 1=점유 타일
int[,] occupancyMap = new int[MapSizeY, MapSizeX];

// 영역 해금: false=미해금 (건설 불가), true=해금 (건설 가능)
bool[,] unlockedArea = new bool[MapSizeY, MapSizeX];

// 영역 해금 여부 확인
public bool IsTileUnlocked(int x, int y)
{
    if (x < 0 || x >= MapSizeX || y < 0 || y >= MapSizeY)
        return false;
    return unlockedArea[y, x];
}

// 건설 가능 여부 확인
public bool CanBuild(int x, int y)
{
    return IsTileUnlocked(x, y) && occupancyMap[y, x] == 0;
}
```
